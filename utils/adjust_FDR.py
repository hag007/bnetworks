import scipy.special
import matplotlib.pyplot as plt
from matplotlib import style
style.use("ggplot")
import scipy
from scipy.stats import hypergeom
from statsmodels.sandbox.stats.multicomp import fdrcorrection0
import logging
sh = logging.StreamHandler()
logger = logging.getLogger("log")
logger.addHandler(sh)
from constants import *
from infra import *

pvals=[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0.002, 0.002, 0.002, 0.002, 0.002, 0.002, 0.002, 0.004, 0.004, 0.004, 0.004, 0.004, 0.004, 0.004, 0.004, 0.004, 0.004, 0.004, 0.004, 0.004, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.008, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.012, 0.014, 0.014, 0.014, 0.014, 0.014, 0.014, 0.014, 0.014, 0.014, 0.014, 0.014, 0.016, 0.016, 0.016, 0.016, 0.016, 0.016, 0.016, 0.016, 0.016, 0.018, 0.018, 0.018, 0.018, 0.018, 0.018, 0.018, 0.018, 0.018, 0.018, 0.018, 0.018, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.024, 0.024, 0.024, 0.024, 0.024, 0.024, 0.024, 0.024, 0.026, 0.026, 0.026, 0.028, 0.028, 0.028, 0.028, 0.028, 0.028, 0.028, 0.028, 0.028, 0.028, 0.028, 0.028, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.032, 0.032, 0.032, 0.032, 0.032, 0.034, 0.034, 0.034, 0.034, 0.034, 0.034, 0.036, 0.036, 0.036, 0.038, 0.038, 0.038, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.042, 0.044, 0.044, 0.044, 0.044, 0.044, 0.044, 0.044, 0.046, 0.046, 0.046, 0.048, 0.048, 0.048, 0.05, 0.052, 0.054, 0.054, 0.054, 0.056, 0.056, 0.056, 0.056, 0.056, 0.056, 0.058, 0.058, 0.058, 0.058, 0.058, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.062, 0.062, 0.064, 0.064, 0.064, 0.066, 0.066, 0.066, 0.066, 0.066, 0.068, 0.068, 0.068, 0.068, 0.068, 0.068, 0.068, 0.068, 0.068, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.072, 0.072, 0.072, 0.072, 0.072, 0.074, 0.076, 0.076, 0.076, 0.078, 0.08, 0.08, 0.082, 0.082, 0.084, 0.084, 0.084, 0.088, 0.088, 0.088, 0.09, 0.09, 0.09, 0.09, 0.092, 0.092, 0.094, 0.094, 0.096, 0.098, 0.098, 0.1, 0.1, 0.1, 0.1, 0.102, 0.106, 0.106, 0.11, 0.11, 0.112, 0.112, 0.112, 0.114, 0.114, 0.116, 0.116, 0.118, 0.12, 0.124, 0.126, 0.128, 0.128, 0.13, 0.13, 0.132, 0.132, 0.134, 0.14, 0.14, 0.142, 0.144, 0.144, 0.144, 0.146, 0.146, 0.148, 0.148, 0.148, 0.148, 0.148, 0.152, 0.158, 0.164, 0.168, 0.17, 0.17, 0.174, 0.176, 0.176, 0.178, 0.18, 0.182, 0.186, 0.186, 0.186, 0.186, 0.192, 0.196, 0.196, 0.198, 0.198, 0.2, 0.202, 0.202, 0.204, 0.204, 0.204, 0.204, 0.21, 0.212, 0.218, 0.218, 0.22, 0.226, 0.242, 0.244, 0.246, 0.256, 0.256, 0.262, 0.282, 0.288, 0.292, 0.292, 0.302, 0.318, 0.324, 0.348, 0.352, 0.362, 0.368, 0.368, 0.374, 0.374, 0.38, 0.4, 0.402, 0.43, 0.44, 0.444, 0.45, 0.468, 0.482, 0.488, 0.49, 0.498, 0.5, 0.508, 0.516, 0.526, 0.526, 0.526, 0.526, 0.546, 0.578, 0.59, 0.63, 0.636, 0.636, 0.636, 0.636, 0.636, 0.658, 0.68, 0.692, 0.714, 0.722, 0.742, 0.742, 0.746, 0.75, 0.752, 0.84, 0.976, 0.978]]

for pval in pvals:
    # pval=np.append(pval,np.zeros(5990-np.size(pval)))
    # pval = [10**(-x) for x in pval]
    pval.sort()
    fdr_results = fdrcorrection0(pval, alpha=0.05, method='indep', is_sorted=False)
    true_counter = len([cur for cur in fdr_results[0] if cur == True])
    print "cutoff: {}".format(-np.log10(pval[true_counter]))
    # print list(fdr_results[1])
    print "true hypothesis: {}".format(true_counter)
    print "total hypothesis: {}".format(np.size(fdr_results[0]))