import scipy.special
import matplotlib.pyplot as plt
from matplotlib import style
style.use("ggplot")
import scipy
from scipy.stats import hypergeom
from statsmodels.sandbox.stats.multicomp import fdrcorrection0
import logging
sh = logging.StreamHandler()
logger = logging.getLogger("log")
logger.addHandler(sh)
from constants import *
from infra import *

pvals=[[2.73987615759768E-05, 2.73987615759768E-05, 5.47975231519535E-05, 8.21962847279303E-05, 0.0001369938, 0.0002191901, 0.0002465889, 0.0002465889, 0.0002465889, 0.0002465889, 0.0002465889, 0.0002465889, 0.0002465889, 0.0003013864, 0.0003561839, 0.0004657789, 0.0004931777, 0.0005205765, 0.0006027728, 0.000684969, 0.0007945641, 0.0007945641, 0.0007945641, 0.0007945641, 0.0008493616, 0.0009041591, 0.0009315579, 0.0009315579, 0.0010411529, 0.0010411529, 0.0011781467, 0.0011781467, 0.0012329443, 0.001260343, 0.0012877418, 0.0013425393, 0.0013699381, 0.0013699381, 0.0013699381, 0.0013973368, 0.0013973368, 0.0014247356, 0.0014247356, 0.0015069319, 0.0015343306, 0.0015343306, 0.0015343306, 0.0015617294, 0.0015617294, 0.0016987232, 0.001726122, 0.0017809195, 0.0017809195, 0.0017809195, 0.0017809195, 0.0017809195, 0.0018083183, 0.001835717, 0.0018631158, 0.0018631158, 0.0018631158, 0.0018905145, 0.0019727108, 0.0019727108, 0.0020001096, 0.0020001096, 0.0020275084, 0.0020275084, 0.0020549071, 0.0020549071, 0.0020549071, 0.0021371034, 0.0021919009, 0.0021919009, 0.0022192997, 0.0022466984, 0.0022466984, 0.0022466984, 0.0022466984, 0.0022740972, 0.0022740972, 0.002301496, 0.0023562935, 0.0023562935, 0.0023562935, 0.0023836923, 0.0023836923, 0.0024658885, 0.0024658885, 0.0024658885, 0.0024932873, 0.0025206861, 0.0025206861, 0.0025480848, 0.0025754836, 0.0025754836, 0.0025754836, 0.0026028823, 0.0026302811, 0.0026302811, 0.0026302811, 0.0026850786, 0.0027398762, 0.0027946737, 0.0027946737, 0.0027946737, 0.0027946737, 0.0027946737, 0.0028220724, 0.0028494712, 0.0029042687, 0.0029590663, 0.002986465, 0.0030412625, 0.0031234588, 0.0031782563, 0.0031782563, 0.0031782563, 0.0031782563, 0.0032604526, 0.0032878514, 0.0033152502, 0.0033152502, 0.0033152502, 0.0033152502, 0.0033426489, 0.0033426489, 0.0033700477, 0.0033974464, 0.0033974464, 0.0033974464, 0.0033974464, 0.003452244, 0.0034796427, 0.0034796427, 0.0035070415, 0.0035070415, 0.0035344402, 0.0036166365, 0.0036166365, 0.0036166365, 0.0036440353, 0.0036714341, 0.0036714341, 0.0036714341, 0.0036714341, 0.0037810291, 0.0038358266, 0.0038358266, 0.0038358266, 0.0039180229, 0.0039180229, 0.0039454217, 0.0040550167, 0.0040550167, 0.0040550167, 0.0040550167, 0.0040550167, 0.0041098142, 0.0041920105, 0.0041920105, 0.004246808, 0.0042742068, 0.0042742068, 0.0042742068, 0.0043290043, 0.0043290043, 0.0043564031, 0.0043838019, 0.0044385994, 0.0044659981, 0.0044933969, 0.0045207957, 0.0047947833, 0.0048495808, 0.0048769796, 0.0048769796, 0.0049043783, 0.0049043783, 0.0049043783, 0.0049317771, 0.0050687709, 0.0050687709, 0.0051235684, 0.0051235684, 0.0051235684, 0.0051509672, 0.0053153597, 0.0053153597, 0.0053427585, 0.0053427585, 0.005397556, 0.005397556, 0.0054249548, 0.0054249548, 0.0054523536, 0.0054797523, 0.0054797523, 0.0054797523, 0.0056167461, 0.0056441449, 0.0056441449, 0.0056441449, 0.0056441449, 0.0056715436, 0.0056715436, 0.0057263412, 0.0057263412, 0.0057537399, 0.0057537399, 0.0057811387, 0.005863335, 0.0058907337, 0.0059181325, 0.0059181325, 0.00597293, 0.00597293, 0.0060277275, 0.0060277275, 0.0060277275, 0.0060277275, 0.0061373226, 0.0061921201, 0.0061921201, 0.0061921201, 0.0062195189, 0.0062195189, 0.0063017152, 0.0063839114, 0.0064113102, 0.006438709, 0.0064661077, 0.0064935065, 0.0065209053, 0.0065209053, 0.0065209053, 0.0066031015, 0.0066031015, 0.0066031015, 0.0066305003, 0.0067126966, 0.0067126966, 0.0067400953, 0.0067400953, 0.0067674941, 0.0068222916, 0.0068222916, 0.0069592854, 0.0069866842, 0.0069866842, 0.007014083, 0.0070414817, 0.007123678, 0.0072332731, 0.0072332731, 0.0072606718, 0.0073154693, 0.0073702669, 0.0073976656, 0.0073976656, 0.0073976656, 0.0074250644, 0.0075072607, 0.0075072607, 0.0075620582, 0.007589457, 0.0076168557, 0.0076442545, 0.0076716532, 0.0077812483, 0.007808647, 0.007808647, 0.007808647, 0.0078360458, 0.0078360458, 0.0079182421, 0.0079456409, 0.0079456409, 0.0079730396, 0.0079730396, 0.0080278371, 0.0081100334, 0.0081100334, 0.0081374322, 0.0081374322, 0.0081374322, 0.0082470272, 0.008274426, 0.0083018248, 0.0083018248, 0.0083018248, 0.0083292235, 0.0083566223, 0.008384021, 0.0084114198, 0.0084662173, 0.0084936161, 0.0085210149, 0.0085484136, 0.0085484136, 0.0085758124, 0.0085758124, 0.0087128062, 0.0087676037, 0.0087676037, 0.0088771988, 0.0089319963, 0.008959395, 0.008959395, 0.0089867938, 0.0090963888, 0.0092059839, 0.0092059839, 0.0092333827, 0.0093155789, 0.0093155789, 0.0093429777, 0.0093429777, 0.0093429777, 0.0094799715, 0.0095073703, 0.0095621678, 0.0095895666, 0.0097265604, 0.0097265604, 0.0098909529, 0.0098909529, 0.0099731492, 0.010000548, 0.0100279467, 0.0100279467, 0.0100279467, 0.0100827443, 0.0100827443, 0.0101375418, 0.0101375418, 0.0101375418, 0.0101923393, 0.0102471368, 0.0102745356, 0.0103293331, 0.0103293331, 0.0103293331, 0.0104389282, 0.0105485232, 0.010575922, 0.0106033207, 0.0106033207, 0.0106033207, 0.0106307195, 0.0106581183, 0.0107129158, 0.0107403145, 0.0107403145, 0.0107951121, 0.0108225108, 0.0108499096, 0.0108773083, 0.0108773083, 0.0109047071, 0.0109047071, 0.0109321059, 0.0109869034, 0.0110143022, 0.0110143022, 0.0110690997, 0.0110964984, 0.0111238972, 0.0111238972, 0.011151296, 0.0111786947, 0.0112882898, 0.0113430873, 0.0114526823, 0.0115348786, 0.0115896761, 0.0117540687, 0.011836265, 0.0118636638, 0.0118910625, 0.0118910625, 0.0118910625, 0.0119184613, 0.0119732588, 0.0119732588, 0.0120828539, 0.0120828539, 0.0121102526, 0.0121102526, 0.0121102526, 0.0121376514, 0.0123842402, 0.012411639, 0.012411639, 0.0124664365, 0.0126308291, 0.0127404241, 0.0127678229, 0.0127678229, 0.0128500192, 0.0131240068, 0.0131240068, 0.0132062031, 0.0132062031, 0.0132336018, 0.0132336018, 0.0132336018, 0.0132610006, 0.0132610006, 0.0132883994, 0.0132883994, 0.0132883994, 0.0132883994, 0.0133157981, 0.0133157981, 0.0133705956, 0.0133979944, 0.0133979944, 0.0133979944, 0.0134253932, 0.0134527919, 0.0135349882, 0.013562387, 0.0135897857, 0.0135897857, 0.0136993808, 0.0136993808, 0.0137541783, 0.0139459696, 0.0139459696, 0.0139459696, 0.014137761, 0.0144391474, 0.0144391474, 0.0144665461, 0.0144665461, 0.0144665461, 0.0144939449, 0.0144939449, 0.0145213436, 0.0145213436, 0.0145213436, 0.0145487424, 0.0145487424, 0.0145487424, 0.0145761412, 0.0146583374, 0.0146857362, 0.0148501288, 0.0148775275, 0.0149597238, 0.0150145213, 0.0151789139, 0.0151789139, 0.0152337114, 0.0152337114, 0.015288509, 0.0153159077, 0.0153159077, 0.0154803003, 0.0155076991, 0.0155350978, 0.0156720916, 0.0158912817, 0.0159186805, 0.0159186805, 0.0160008768, 0.0160282755, 0.0160556743, 0.0161926681, 0.0162748644, 0.0163570607, 0.0163570607, 0.0164940545, 0.0164940545, 0.0164940545, 0.0164940545, 0.016548852, 0.016548852, 0.016548852, 0.0167132446, 0.0169324347, 0.0169598334, 0.0169872322, 0.0170420297, 0.017124226, 0.0172064223, 0.0173160173, 0.0174256124, 0.0174256124, 0.0175078086, 0.0175900049, 0.0177269987, 0.0177269987, 0.0177269987, 0.0177269987, 0.0178639925, 0.0180283851, 0.0180831826, 0.0181105814, 0.0181105814, 0.0183023727, 0.0183297715, 0.0183571703, 0.0184393665, 0.0185215628, 0.0185489616, 0.0186311579, 0.0186585566, 0.0187407529, 0.0187955504, 0.0187955504, 0.0188229492, 0.0188229492, 0.018850348, 0.0190695381, 0.0190695381, 0.0190695381, 0.0190695381, 0.0190695381, 0.0190695381, 0.0190969368, 0.0190969368, 0.0190969368, 0.0190969368, 0.0192887281, 0.0193435257, 0.0194531207, 0.0195079182, 0.019535317, 0.0195627158, 0.0196997096, 0.0197271083, 0.0197545071, 0.0198093046, 0.0198641021, 0.0198641021, 0.0199188997, 0.0199462984, 0.0199736972, 0.0200558935, 0.0200832922, 0.020110691, 0.0201380898, 0.020220286, 0.0202750836, 0.0203572799, 0.0203846786, 0.0206038687, 0.0207134638, 0.0208230588, 0.0208504576, 0.0208504576, 0.0209052551, 0.0209600526, 0.0209600526, 0.0211244452, 0.0211244452, 0.0211244452, 0.0212066415, 0.021371034, 0.0215080278, 0.0215354266, 0.0215628254, 0.0217820155, 0.0217820155, 0.0218642117, 0.0219190093, 0.0220560031, 0.0223025919, 0.0223573894, 0.022412187, 0.022412187, 0.022412187, 0.0226039783, 0.0226861746, 0.0227409721, 0.0227957696, 0.0231793523, 0.0232889473, 0.0234807387, 0.0235355362, 0.0235903337, 0.0236451312, 0.0237273275, 0.0238095238, 0.0238095238, 0.0238917201, 0.0238917201, 0.0241383089, 0.0242753028, 0.0244122966, 0.0244122966, 0.0244670941, 0.0245492904, 0.0245492904, 0.0246588854, 0.0246588854, 0.0246588854, 0.0246862842, 0.0247958792, 0.024932873, 0.0250150693, 0.0254260507, 0.0254534495, 0.0254808483, 0.025508247, 0.0256452408, 0.0257548359, 0.0258370322, 0.0262206148, 0.0263302099, 0.0263576086, 0.0263850074, 0.0264398049, 0.0264946024, 0.0267685901, 0.0269055839, 0.0269603814, 0.0270699764, 0.0270699764, 0.027124774, 0.0271795715, 0.0272069702, 0.027234369, 0.0273165653, 0.0275357554, 0.0275631541, 0.0275631541, 0.0275631541, 0.0275631541, 0.0276179517, 0.0276727492, 0.0277823442, 0.0277823442, 0.027809743, 0.0279467368, 0.0279467368, 0.0280289331, 0.0280289331, 0.0281659269, 0.0281659269, 0.0282207244, 0.0284125158, 0.0284399145, 0.0284673133, 0.028494712, 0.0286043071, 0.0286591046, 0.0288508959, 0.0289056935, 0.0289056935, 0.0289878897, 0.0293440736, 0.0293440736, 0.0295084662, 0.0296728588, 0.0296728588, 0.0297002575, 0.0297824538, 0.0298098526, 0.0298098526, 0.0298372514, 0.0298920489, 0.0298920489, 0.0299468464, 0.0299468464, 0.0299468464, 0.0300290427, 0.0300564414, 0.030111239, 0.0302482328, 0.0304948216, 0.0306592142, 0.0307688092, 0.0308236068, 0.0309058031, 0.0309606006, 0.0309879993, 0.0310153981, 0.0312345882, 0.0312893857, 0.0315085758, 0.0316455696, 0.0317825634, 0.0323031399, 0.0325771275, 0.032631925, 0.032631925, 0.0327415201, 0.0327689188, 0.0330155077, 0.0331251027, 0.033207299, 0.0333442928, 0.0333990904, 0.0338922681, 0.0340840594, 0.0340840594, 0.0343032495, 0.034358047, 0.0345772371, 0.0346868322, 0.0350156173, 0.0350704148, 0.0350978136, 0.0353444024, 0.0353992, 0.0353992, 0.0356731876, 0.0357553839, 0.0358375801, 0.0358923777, 0.0358923777, 0.0359197764, 0.0360293715, 0.0362759603, 0.0364403529, 0.0366047455, 0.0369061318, 0.0371801195, 0.0372897145, 0.0373171133, 0.0375637021, 0.0376458984, 0.0378376897, 0.0379472848, 0.0380568798, 0.0382212724, 0.0383308674, 0.03849526, 0.0386596526, 0.0391528303, 0.0391802291, 0.0392350266, 0.0392624253, 0.0392898241, 0.0393172229, 0.0396186092, 0.0397282043, 0.0397282043, 0.0399199956, 0.0401665845, 0.0405775659, 0.0406597622, 0.0407693572, 0.040796756, 0.0410159461, 0.0410433448, 0.0413995287, 0.041481725, 0.0416735164, 0.0423858842, 0.0423858842, 0.0426872705, 0.0428790619, 0.0429886569, 0.0432352458, 0.0433996383, 0.0434270371, 0.0434818346, 0.043892816, 0.0441120061, 0.0441668037, 0.0441668037, 0.0441668037, 0.044358595, 0.04446819, 0.0445229876, 0.0445777851, 0.0446599814, 0.0447421777, 0.0447969752, 0.044933969, 0.045043564, 0.0456463368, 0.0462491095, 0.0462765083, 0.0467148885, 0.0468792811, 0.0468792811, 0.0471532687, 0.04734506, 0.0475094526, 0.0475916489, 0.0478382377, 0.0478656365, 0.0478930352, 0.047920434, 0.0479752315, 0.0484684092, 0.0486328018, 0.0488519919, 0.0490985807, 0.049756151, 0.049756151, 0.0499205436, 0.0499479424, 0.0500027399, 0.05022193, 0.0503041263, 0.0503041263, 0.0504411201, 0.0513452792, 0.0527974136, 0.0535645789, 0.0544413393, 0.0547701244, 0.0552907009, 0.0554276947, 0.0556742835, 0.055729081, 0.0560852649, 0.0560852649, 0.0564140501, 0.0564962464, 0.0567154365, 0.0567976327, 0.056879829, 0.0569346266, 0.0569346266, 0.0570168228, 0.0575921968, 0.0588525399, 0.0590443312, 0.0608800482, 0.0608800482, 0.0613732259, 0.0614006247, 0.0626061702, 0.0630171516, 0.0634007343, 0.0636199244, 0.0638391145, 0.0644966847, 0.0644966847, 0.0645514823, 0.0647706724, 0.0650172612, 0.0654556414, 0.0655926352, 0.0660310154, 0.0671269659, 0.0671543646, 0.0672365609, 0.0672913584, 0.0676749411, 0.0677023399, 0.0677571374, 0.0677845361, 0.0677845361, 0.0680859225, 0.0681681188, 0.0684695052, 0.0689626829, 0.0690448792, 0.0690722779, 0.0697024494, 0.0700312346, 0.0710723875, 0.0710723875, 0.0716477615, 0.0719765467, 0.0723601293, 0.0729903008, 0.0732368897, 0.0736204724, 0.0744972327, 0.0754287906, 0.0766617349, 0.0779768754, 0.0782508631, 0.0791002247, 0.0792646172, 0.0792646172, 0.0806893528, 0.081127733, 0.0821962847, 0.0832100389, 0.0832648364, 0.0836758179, 0.0843059894, 0.0850731547, 0.085264946, 0.0863882952, 0.0874020494, 0.0875116445, 0.0877856321, 0.088141816, 0.088141816, 0.0887993863, 0.0894295578, 0.0897309442, 0.0898131404, 0.0920050414, 0.0924434216, 0.0934845745, 0.0953202915, 0.0963614445, 0.0974847937, 0.0976217875, 0.098827333, 0.0992657132, 0.100087676, 0.1011836265, 0.1014302154, 0.1018685955, 0.1018685955, 0.1019507918, 0.1061154036, 0.1063619924, 0.1064441887, 0.1064441887, 0.1070469615, 0.1086360896, 0.1086360896, 0.1086360896, 0.1117321497, 0.1117321497, 0.1124445175, 0.1142802345, 0.1183900488, 0.1184996438, 0.1186366376, 0.1192394104, 0.1200613732, 0.1220888816, 0.1228286481, 0.1237328073, 0.1245821689, 0.1257877144, 0.1268014686, 0.1274864376, 0.1296783385, 0.1299523262, 0.1329935887, 0.1332675763, 0.1346101156, 0.1346375144, 0.137322593, 0.137322593, 0.137322593, 0.137322593, 0.137322593, 0.1377609732, 0.1379801633, 0.1381171571, 0.1401172667, 0.140199463, 0.1409940271, 0.1440078908, 0.1468025645, 0.1476793249, 0.1486108828, 0.1498164283, 0.1506931887, 0.150994575, 0.1516247466, 0.1517069428, 0.1526932983, 0.1550769905, 0.1601731602, 0.1615430983, 0.1624746561, 0.16261165, 0.1642829744, 0.1687489725, 0.1692969478, 0.1728587868, 0.1790509069, 0.1808592252, 0.1820099731, 0.1836812976, 0.1900926078, 0.1908871719, 0.1932160666, 0.1945312072, 0.1955997589, 0.1961751329, 0.1975724697, 0.2020110691, 0.2025864431, 0.2068606499, 0.2076278152, 0.2119842183, 0.2195736753, 0.2225053428, 0.2328620746, 0.2425338375, 0.2568633898, 0.2580141378]]
for pval in pvals:
    pval.sort()
    fdr_results = fdrcorrection0(pval, alpha=0.05, method='indep', is_sorted=False)
    true_counter = len([cur for cur in fdr_results[0] if cur == True])
    # print list(fdr_results[1])
    print "true hypothesis: {}".format(true_counter)
    print "total hypothesis: {}".format(np.size(fdr_results[0]))